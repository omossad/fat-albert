Harry Potter is forced to defend himself against charges of using magic while underage, and in the presence of his Muggle cousin Dudley, after the two are attacked by Dementors. The Order of the Phoenix, a secret organisation founded by Albus Dumbledore, inform the now pending expulsion Harry that the Ministry of Magic is oblivious to Lord Voldemort's return; under the Ministry's influence, The Daily Prophet has launched a smear campaign towards Harry and Dumbledore following Harry's encounter with Voldemort at the end of the previous year. This encounter had a huge psychological effect on Harry  he has nightmares not only about what happened in the graveyard but also about the Department of Mysteries at the Ministry of Magic. While at the Order's headquarters, Harry's godfather, Sirius Black, mentions that Voldemort is after an object which he did not have last time.

Upon arrival at Hogwarts, Harry learns that Minister for Magic Cornelius Fudge has appointed a new Defence Against the Dark Arts professor: Dolores Umbridge, a senior Ministry official who refuses to teach practical magic due to her belief that Dumbledore is forming a rebellion against the Ministry. Umbridge and Harry immediately clash, as she is oblivious to Voldemort's return and punishes Harry for his "lies" by forcing him to write a message with a magic quill, causing the words "I must not tell lies" to be carved into the back of his hand. When Ron and Hermione notice Harry's scars, they are outraged but he refuses to go to Dumbledore, who has distanced himself from Harry since the summer. As Umbridge's control over the school increases, Ron and Hermione aid Harry in forming a secret group to train students in defensive spells, calling themselves "Dumbledore's Army". The Slytherin students are recruited by Umbridge to expose the group. Meanwhile, Harry and Cho Chang develop romantic feelings for each other and begin a relationship during Christmas, Cho being Harry's first kiss at the last DA meeting before the holidays. However, Harry worries that his increasingly erratic behaviour is becoming more like Voldemort's.

Harry has a vision involving an attack upon Arthur Weasley in the Department of Mysteries, from the point of view of Arthur's attacker. Concerned that Voldemort will exploit this connection to Harry, Dumbledore instructs Professor Snape to give Harry Occlumency lessons to defend his mind from Voldemort's influence. These lessons increase Harry's psychological problems, as he is forced to relive all his bad experiences. The connection between Harry and Voldemort leads Harry to further isolate himself from his friends. Meanwhile, Bellatrix Lestrange, Sirius' deranged cousin, escapes from Azkaban along with nine other Death Eaters. At Hogwarts, Umbridge and her Inquisitorial Squad uncover Dumbledore's Army after illegally interrogating Cho with Veritaserum (unbeknownst to Harry and the rest of the group). Dumbledore covers up for Harry, but escapes as Fudge orders his arrest. With Dumbledore gone, Umbridge becomes the new Headmistress and exercises even stricter control over the campus. Harry's relationship with Cho falls apart, as he believes she betrayed Dumbledore's Army to Umbridge. During Occlumency lessons, Harry finally snaps and deflects the spell back on Snape, allowing Harry to discover through Snape's memories why he hated Harry's father James, who often bullied him. Enraged that Harry has witnessed these memories, Snape ends the lessons.

During an Ordinary Wizarding Level (O.W.L.) exam, the Weasley twins finally revolt and set off fireworks in the Great Hall, causing chaos for Umbridge. During this event, Harry has a vision of Sirius being tortured by Voldemort within the Department of Mysteries. Harry, Ron and Hermione rush to Umbridge's fireplace to alert the Order via the Floo Network, since hers is the only fireplace not being monitored, but Umbridge stops them before they can do so, also revealing what she did to Cho. When she tortures Harry and threatens to use the Cruciatus Curse to get information out of Him about the trio's intentions, Hermione tricks Umbridge into entering the Forbidden Forest in search of Dumbledore's "secret weapon". She and Harry lead her to the hiding place of Hagrid's half-giant brother, Grawp, only to be confronted by centaurs who kidnap Umbridge after she attacks them. Harry, Hermione, Ron, Luna, Neville and Ginny fly to the Ministry of Magic on Thestrals in an attempt to save Sirius.

The six enter the Department of Mysteries where they uncover a bottled prophecy involving Harry and Voldemort, the object Voldemort was after. However, they are ambushed by Death Eaters including Lucius Malfoy and Bellatrix Lestrange. Lucius reveals that Harry only saw a dream of Sirius being tortured; it was a method to lure Harry into the Death Eaters' grasp, not an actual situation. Lucius attempts to persuade Harry to give him the prophecy, telling him it will reveal why Voldemort couldn't kill Harry when he was an infant. Harry refuses and a fight between Dumbledore's Army and the Death Eaters ensues. The Death Eaters take everyone except Harry as hostages, threatening to kill them unless he surrenders the prophecy.

Harry obliges just as Sirius and Remus Lupin arrive with Order members Nymphadora Tonks, Kingsley Shacklebolt and Mad-Eye Moody. They attack the Death Eaters, attempting to rescue the Dumbledore's Army members. In the midst of the battle, Lucius drops the prophecy, destroying it. Harry and Sirius duel him. Just as Sirius overpowers Lucius, Bellatrix kills Sirius. Despite Remus trying to hold him back, Harry goes after Bellatrix. Harry chases and corners Bellatrix in the Atrium and attempts to perform the Cruciatus Curse on her, but to little avail (it knocks her down). Voldemort appears, but Dumbledore arrives through the Floo Network moments before Voldemort can kill Harry.

A huge duel between Voldemort and Dumbledore ensues, destroying much of the Atrium, while Bellatrix escapes. After the two prove evenly matched, Voldemort possesses Harry to try to get Dumbledore to sacrifice Harry in the hope of killing him, but the love Harry feels for his friends and Sirius makes it impossible for Voldemort to remain in his body. Ministry officials arrive before Voldemort disapparates; Fudge is forced to admit that Voldemort has returned and resigns as Minister. Umbridge is finally removed from Hogwarts. Dumbledore returns as headmaster of Hogwarts after he and Harry are exonerated. Dumbledore explains that he distanced himself from Harry throughout the year hoping it would lessen the risk of Voldemort using their connection. Harry comes to terms with the prophecy; "Neither can live while the other survives."

As Harry and his friends head towards the Hogwarts Express, Harry tells his friends that even though a war is beginning, unlike Voldemort, they have something worth fighting for.