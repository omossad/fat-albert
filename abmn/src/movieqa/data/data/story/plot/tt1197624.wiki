In a 1999 Philadelphia violent home invasion, engineer Clyde Shelton (Gerard Butler) is forced to witness the rape and murder of his wife and young daughter, by Clarence James Darby (Christian Stolte) and his accomplice Rupert Ames (Josh Stewart). Prosecutor Nick Rice (Jamie Foxx) is unable to use DNA evidence to securely convict both accused. Unwilling to take a chance on lowering his high and yet unbeaten 96% conviction rate, he chooses to make a deal with Darby (the actual murderer), letting him plead guilty to a lesser charge, in return for testifying against Ames. Ames is falsely found guilty of masterminding the break-in and both murders and is sentenced to death. Shelton feels betrayed by Rice's actions, as he had pleaded with him not to make the deal and to at least try convict both of them, and because he chose to release the actual killer. Darby serves his shortened sentence and is released just a few years later.

Ten years later, Ames's time on death row is up as he continues protesting his innocence. Unknown to the prosecutors and the witnesses, the cardiotoxic drug that's usually used in executions has been replaced with another drug (Potassium bromide), causing Ames to die an extremely painful death. Evidence relating to tampering with the drug implicates his accomplice Darby. As the police draw near to arrest him, an anonymous caller alerts Darby and offers him a way to escape, directing him to a remote location nearby. Shelton, disguised as a cop, reveals himself as the caller and paralyzes Darby with puffer fish venom. He proceeds to strap Darby to a table, opposite a full-length mirror, and tortures and extremely brutally dismembers him in revenge for killing his wife and daughter. He video captures the entire proceedings. When Darby's remains are found, circumstantial evidence tentatively ties his death to Shelton. Despite knowing the evidence is weak, Shelton surrenders himself, and points out the flaws in Rice's case against him. Shelton, knowing Rice will need a confession, baits Rice by telling him he will give a full confession if Rice will get a couple of things for him; the first being a new comfy bed for his cell.

As he leaves the interrogation room, Rice receives a phone call from his wife, and learns that Shelton had sent a copy of the snuff film of Darby's brutal murder to his house, traumatizing his young daughter. He initially refuses to bargain with Shelton in order to get a confession but District Attorney Jonas Cantrell (Bruce McGill) orders Rice to make the deal. In court, Shelton represents himself. He successfully argues that he should be granted bail, citing weak evidence and lack of criminal record but when this is granted, he proceeds to berate the judge for accepting the "bullshit" legal precedents he himself cited and for being too eager to let madmen and murderers back on the street. The judge jails Shelton for contempt of court.

Once in jail, Shelton demands a porterhouse steak lunch be delivered to his cell by a specific time, in return for disclosing where to find Darby's lawyer, who they then discover was reported missing three days earlier. Rice agrees, though the lunch is delayed by a few minutes due to the warden's security measures and their wish. Once he has his meal, Shelton provides a set of coordinates, where Rice and the others find Darby's lawyer. He was buried alive in a crate but suffocated when his air supply ran out minutes earlier. Back at the jail, Shelton invites his cellmate to join him in his steak meal and then kills him by stabbing him in the neck with the steak's bone. Upon discovery of the murder, the warden moves Shelton into solitary confinement.

Following a tip, Cantrell arranges a meeting with a CIA contact and takes Rice along. They learn that Shelton had in fact worked with the agency previously as a "brain"; a highly trained agent whose job was creating devices to assassinate people in imaginative ways. Further, they are warned that Shelton has no contacts but is capable of killing anyone he wishes, no matter who they are or where he is. The contact warns them that Shelton does nothing without a reason, and if he's in solitary confinement at the prison, he's there because he wants to be there, and not that they put him there. During a meeting with Rice and Cantrell, the judge that presided over Darby/Ames' case, is killed when she answers her cell phone. Shelton demands Rice to drop all charges against him or more people will die - he has until 6:00 am to do so. When Rice again fails to meet the demands, a number of Rice's assistants are killed by car bombs, one of them is Sarah Lowell (Leslie Bibb). Rice immediately moves his family to a safe house. As Rice and Cantrell leave the funeral of Lowell, Cantrell is killed by a weaponized bomb disposal robot operated by an unseen person. The frustrated and ill-tempered mayor (Viola Davis) puts the city under lockdown and promotes Rice to acting District Attorney.

While making a further background check on Shelton, Rice discovers that he used to own an auto garage less than one mile from the prison. Exploring this property, Rice and Detective Dunnigan (Colm Meaney) find an underground tunnel that leads to a cache of guns, disguises, and other equipment right below the solitary confinement cells. Evidence in the tunnel points Rice to Shelton's next target - city hall, where the mayor is holding an emergency meeting with all the city officials. Rice and his men can't find Shelton, but discover evidence pointing to a cell-phone-activated suitcase bomb in the room directly below the meeting.

Shelton returns to his garage after planting the city hall bomb, then returns to his cell. He is surprised to find Rice waiting for him. Rice states that it is the end of the road for him and he should do the right thing. Shelton is convinced that he is doing the right thing but Rice just has to see it that way. Rice explains that it is not right murdering people and he is causing the same pain that he is going through. Shelton suggests another deal, but Rice states that he no longer makes deals with murderers saying Shelton taught him that. Rice pleads with him not to detonate that last bomb. Shelton hesitates but detonates the bomb. Rice quickly leaves the cell, revealing that it was a trick. Shelton discovers the bomb handcuffed to his bed. He sits on his bed pulling out his daughter's bracelet and gazing at it with a look of sadness as the bomb explodes.